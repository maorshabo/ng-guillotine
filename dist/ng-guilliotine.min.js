!function(t,e){"use strict";var i=t.module("ngGuillotine",[]);i.directive("ngGuillotine",[function(){var e=document.createElement("canvas");e=!(!e.getContext||!e.getContext("2d"));{var i,a,n,o,l,c,r,g,s,u;Math.PI/180}return{restrict:"EA",replace:!0,scope:{image:"=",resultImage:"="},template:'<div class="cropWrapper"><div class="frame"><img class="gulliotineCropImage" /></div><div id="controls"><a title="Rotate left" ng-click="rotateLeft()"><i class="fa fa-rotate-left"></i></a><a title="Zoom out" ng-click="zoomOut()"><i class="fa fa-search-minus"></i></a><a title="Fit image" ng-click="fitImage()"><i class="fa fa-arrows-alt"></i></a><a title="Zoom in" ng-click="zoomIn()"><i class="fa fa-search-plus"></i></a><a title="Rotate right" ng-click="rotateRight()"><i class="fa fa-rotate-right"></i></a></div></div>',link:function(h,f,m){function d(t,e){h.resultImage=v(t)}function v(t){return e?(i=document.createElement("canvas"),a=i.getContext("2d"),i.width=k.width,i.height=k.height,a.clearRect(0,0,i.width,i.height),n=t.x/t.scale,o=t.y/t.scale,l=t.w/t.scale,c=t.h/t.scale,r=-i.width/2,g=-i.height/2,s=t.w,u=t.h,w(t),i.toDataURL()):!1}function w(t){a.clearRect(0,0,i.width,i.height),a.save(),a.translate(i.width/2,i.height/2),a.rotate(t.angle*Math.PI/180),a.drawImage(p[0],n,o,l,c,r,g,s,u),a.restore()}var I=jQuery,p=I(f).find(".gulliotineCropImage"),R={width:250,height:250,init:{scale:1},onChange:d},k=t.extend({},R,h.$eval(m.ngGuillotine));h.rotateLeft=function(){p.guillotine("rotateLeft")},h.rotateRight=function(){p.guillotine("rotateRight")},h.fitImage=function(){p.guillotine("fit")},h.zoomIn=function(){p.guillotine("zoomIn")},h.zoomOut=function(){p.guillotine("zoomOut")},I(f).find(".frame").css("width",k.width),h.$watch("image",function(t){t&&(p.attr("src",t),p.guillotine("remove"),p.guillotine(k),h.fitImage())})}}}])}(angular);